<link rel="import" href="../framework/polymer/polymer.html">

<!--
cybelia.kao 2017.07: Single radio button component
main feature: functionally similar to vanilla radio button, click on text will also work
-->

<dom-module id="single-radio">
    
    <script>
    Polymer({
        is: 'single-radio',
        properties: {
            name: {
                type: String,
                value: ""
            },
            text: {
                type: String,
                value: ""
            },
            value: {
                type: String,
                value: ""
            },
            checked: {
                type: Boolean,
                notify: true
            }
        },
        ready: function() {
            // Construct the DOM tree manually, so that Polymer do not generate a shadow DOM root
            // and so that the radio button would actually work...
            var paragraph = document.createElement('p');
            
            var input = document.createElement('input');
            input.type = "radio";
            input.name = this.name;
            input.title = this.value;
            input.value = this.value;
            input.checked = this.checked;
            paragraph.appendChild(input);
            this.objInput = input;
            
            var text = document.createElement('span');
            text.style.cursor = "pointer";
            text.style.color = "#6668A0";
            text.linkedInput = input.id;
            text.title = this.value;
            text.innerHTML = this.text;
            paragraph.appendChild(text);
            
            this.appendChild(paragraph);
            
            input.addEventListener('change', function(event) {
                this.checked = event.target.checked;
                this.dispatchEvent(new Event('change', {target: this, bubbles: true}));
            }.bind(this));
            
            // When clicked on text, also trigger the event on radiobox
            text.addEventListener("click", function(event) {
                input.checked = true;
                input.dispatchEvent(new Event('change', {target: input}));
            }.bind(this));
            
            // When the component property changed, also reflect that change to underlying radiobox
            // Without template, two-way binding seem to be hard...
            this.addEventListener('checked-changed', function(event) {
                input.checked = this.checked;
            }.bind(this));
        }
    });
    </script>

</dom-module>
